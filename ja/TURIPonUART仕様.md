# TURIPonUART仕様

## 概要

TURIPonUARTは、UART上でTURIPを動作させるための仕様です。
テキストベースかつ対話式な仕様なため、人が直接TURIPモジュールとやりとりすることが可能なのが特徴です。

## 物理仕様

TURIPonUARTは明確な物理仕様を有しません。
ただし、参考として標準的な物理仕様を示します。

### 標準的な物理仕様

電源電圧およびロジックレベルは3.3Vです。
ピンアサインは次の通りとなります。
4番ピンはオープンですが、マイコンのリセットピンなどと接続し、セルフプログラミング等に用いることも可能です。必要に応じてコネクタは自由に決めることができます。

ピン番号 | 機能
-------|-----
1      | TX
2      | RX
3      | 3.3V
4      | (n.c.)
5      | GND

## ロジック仕様

ボーレートは9600bpsです。
パリティービットはありません。

## コマンド体系

TURIPonUARTコマンドは、HTTPライクなものです。
コマンドは`<LF>`または`<CR><LF>`で終端されます。
また、TURIPデバイスからの応答はJSON形式となります。

### ポートへの読み書き

#### 読み出し

TURIPデバイスからの読み込みはポート番号と改行コードです。
具体的な書式は以下の通りです。

`[port]<LF>`

#### 書き込み

TURIPデバイスへの書き込はポート番号の後にデータを送ります。
ポート番号とデータ間にはスペースが入ります。
具体的な書式は以下の通りです。

`[port] [データ]<LF>`

### TURIPモジュールの応答

TURIPモジュールからの応答はJSON形式となります。
JSONオブジェクトの中身は次の通りです。

Key    | Value type         | 概要
-------|--------------------|------------------------------------
status | int             | TURIPデバイスからのステータスコード
port   | int             | アクセスしたポート番号
type   | string             | ポートに格納されているデータの型
data   | (ポート内容に依存)     | ポートに格納されているデータ本体

#### ステータスコード

ステータスコードはHTTPに似た体系を有します。

code | 説明
-----|-----------------------------------------
200  | 正常な通信を行った
400  | リクエストが不正
404  | 存在しないポート、デバイスにアクセスした
500  | 内部エラー

### TURIP bridge

TURIP bridgeに対応している場合、読み込みの書式は以下の通りです。

`[id]/[port]<LF>`

また、書き込みの書式は以下の通りです。

`[id]/[port] [データ]<LF>`
