# Tiny Universal (Tottori University) Robot Interface Protocol (TURIP) 0.20 仕様

## TURIPの概要

TURIPは、電子モジュールとの通信を簡単化するためのインターフェイス仕様です。
開発者への負担を最小限に抑え、迅速なプロトタイピングを可能とすることを目的としています。
センサの数値データなど、小容量のデータのやりとりに適しています。

## TURIPが対応するデータ形式

TURIPでは、予め決められたデータ形式（データ型）を有するデータを交換することができます。
データ型の種類は以下に示す通りです。

| 名称        | 仕様                  |
|------------|----------------------|
| bool       | ブール型               |
| int8       | 8bit整数型             |
| int16      | 16bit整数型            |
| int32(int) | 32bit整数型            |
| int64      | 64bit整数型            |
| float      | 単精度(32bit)浮動小数点型 |
| double     | 倍精度(64bit)浮動小数点型 |
| string     | テキスト               |

## ポート

TURIPはTURIPデバイス内部に構築された「ポート」にアクセスすることでデータ交換を実現しています。
ポートにはそれぞれにデータが格納されています。
ポートの範囲は0から127までです。
ポートには本仕様書によって定義されているポートと、自由に定義できるポートがあります。
ポートの定義を以下に示します。

番号      | データ型 | 機能
----------|----------|------------------
0x00      | -        | デバイスリセット
0x00-0x3f | (任意)   | 自由に定義可能
0x40      | int32    | 型番
0x41-0x43 | -        | 予約
0x44      | int32    | シリアル番号
0x45-0x47 | -        | 予約
0x48      | int8     | ローカルアドレス
0x49-0x7e | -        | TURIP拡張仕様領域
0x7f      | -        | null(機能なし)

0x00-0x3fの範囲は、マニフェストによって定義されます。
0x48-0x7eの領域は今後の仕様拡張のために予約されています。

## 対応プロトコル

TURIPは複数の既存プロトコルに対応しています。
それぞれのプロトコルにおける仕様は、別紙で定義します。

プロトコル       | ドキュメントタイトル
---------------|------------------
SPI            | TURIPonSPI 仕様
UART           | TURIPonUART 仕様
HTTP           | TURIPonHTTP 仕様

### バイナリインターフェイス/テキストインターフェイス

TURIPには「バイナリインターフェイス」と「テキストインターフェイス」が存在します。
バイナリインターフェイスは軽量性を重視しており、マイコン-センサデバイス間等の通信に有利です。
テキストインターフェイスは柔軟性を重視しており、コンピュータ間の通信、中・長距離の通信に有利です。
それぞれでインターフェイスで用いるプロトコルは決まっています。

- バイナリインターフェイス
  - SPI
- テキストインターフェイス
  - UART
  - HTTP

## マニフェスト

TURIPモジュールは、マニフェストと呼ばれるドキュメントでその仕様を表現することが可能です。
マニフェストは型番毎に定義され、マニフェストリポジトリ(manifest.turip.org)に登録されています。
マニフェストの取得はHTTP GETメソッドによって、
`http(s)://manifest.turip.org/[型番]`にアクセスします。
型番は16進数表記です。

## ID

TURIPデバイスは、それぞれ固有のIDを有します。
IDは型番とシリアル番号を組み合わせた64bitの整数です。
型番は、申請毎にTURIP管理団体が発行します。
ただし、0x0001-0x0fffの範囲は、管理団体に登録せずに自由に利用可能です。
シリアル番号はベンダーが管理します。
シリアル番号を定義しない場合は、0x0000とします。

### IDの省略表示

テキストモードでは、IDを省略表記することが可能です。

`[型番]-[シリアル番号]`

それぞれ、上位の'0'は省略できます。
たとえば、型番が`0x00001234`、シリアル番号が`0x0000abcd`の場合、省略表記は
`1234-abcd`
となります。

## 拡張機能

### TURIP bridge

TURIPの拡張機能として、ツリー状に多段接続することができる機能です。テキストインターフェイスのみが対応します。
